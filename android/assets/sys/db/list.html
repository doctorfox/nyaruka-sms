{% extends "db/editor.html" %}

{% block content %}
<div id="table_container">

<div id="table_header" class="gradient">
  <div class="buttons right">
    <a href="#" id="delete_button" class="button small destructive">delete</a>
    <a href="#" id="add_button" class="button small">add</a>
  </div>

  <h2><a href="/db/">db</a> &gt; {{ collection.name }}</h2>
</div>

<div id="table_contents">
<table width="100%" cellspacing=0 cellpadding=0>
<tr>
  <th width="40">id</th>
  {% for key in keys %}
  <th>{{ key }}</th>
  {% endfor %}
</tr>

{% for record in records %}
<tr class="record_row {% cycle 'row1','row2' %}" record_id="{{ record.id }}">
  <td>{{ record.id }}</td>
  {% for key in keys %}
  <td>{{ record|get:key }}</td>
  {% endfor %}
</tr>
{% endfor %}

</table>

<div id="table_footer" class="gradient">
  <h2>
    {{ records|length }} records
  </h2>
</div>

</div>

<form id="delete_form" method="POST" action="/db/{{collection.name}}/delete/">
</form>
{% endblock %}

{% block extrascript %}
<script>
  $(document).ready(function(){
    $(".record_row").click(function(){
      document.location.href = "/db/{{collection.name}}/" + $(this).attr("record_id") + "/";
    });

    $("#add_button").click(function(event){
      event.preventDefault(); 
      showEditor("Add");
    });

    $("#delete_button").click(function(event){
      if (confirm("Remove collection?")){
        $("#delete_form").submit();
      }
      event.preventDefault();
    });
  });
</script>
{% endblock %}
